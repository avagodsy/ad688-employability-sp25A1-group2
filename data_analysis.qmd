---
title: "Data Analysis"
subtitle: "Comprehensive Data Cleaning & Exploratory Analysis of Job Market Trends"
author:
  - name: Mahira Ayub
    affiliations:
      - id: bu
        name: Boston University
        city: Boston
        state: MA
  - name: Ava Godsy
    affiliations:
      - ref: bu
  - name: Joshua Lawrence
    affiliations:
      - ref: bu
bibliography: references.bib
csl: csl/econometrica.csl
format: 
  html:
    theme: minty
    toc: true
    number-sections: true
    df-print: paged
---


```{python}
import pandas as pd

# Load the dataset
data = pd.read_csv('data\lightcast_job_postings.csv')
# Extract Job_Postings table
job_postings = data[['ID', 'TITLE_RAW', 'TITLE_CLEAN', 'POSTED', 'EXPIRED',
                     'SALARY_FROM', 'SALARY_TO', 'MIN_YEARS_EXPERIENCE',
                     'MAX_YEARS_EXPERIENCE', 'SKILLS', 'SPECIALIZED_SKILLS',
                     'SOFTWARE_SKILLS', 'EMPLOYMENT_TYPE']]
job_postings.to_csv('output/job_postings.csv', index=False)

# Extract Company table
company= data[['COMPANY_NAME', 'COMPANY_RAW', 'COMPANY_IS_STAFFING']]
company["COMPANY_ID"] = company.index
company.to_csv('output/company.csv', index=False)
```

## Dropping Unncessary Columns

Answer the Questions
+ Which columns are irrelevant or redundant?
+ Why are we removing multiple versions of NAICS/SOC codes?
+ How will this improve analysis? 
```{python}
columns_to_drop = [
'ID',
'LAST_UPDATED_TIMESTAMP',
'DUPLICATES',
'NAICS2',
'NAICS2_NAME',
'NAICS3',
'NAICS3_NAME',
'NAICS4',
'NAICS4_NAME',
'NAICS5',
'NAICS5_NAME',
'NAICS6',
'NAICS6_NAME',
'SOC_2021_2',
'SOC_2021_2_NAME',
'SOC_2021_3',
'SOC_2021_3_NAME',
'SOC_2021_4',
'SOC_2021_4_NAME',
'SOC_2',
'SOC_2_NAME',
'SOC_3',
'SOC_3_NAME',
'SOC_4',
'SOC_4_NAME',
'SOC_5',
'SOC_5_NAME',
'NAICS_2022_2',
'NAICS_2022_2_NAME',
'NAICS_2022_3',
'NAICS_2022_3_NAME',
'NAICS_2022_4',
'NAICS_2022_4_NAME',
'NAICS_2022_5',
'NAICS_2022_5_NAME'
]
data.drop(columns=columns_to_drop, inplace=True)
```

## Handling Missing Values
Answer the question: How should missing values be handled? 

```{python}
import missingno as msno
import matplotlib.pyplot as plt

# Visualize missing data
msno.heatmap(data)
plt.title("Missing Values Heatmap")
plt.show()

# Fill missing values
data["SALARY"].fillna(data["SALARY"].median(), inplace=True)
data["NAICS_2022_6_NAME"].fillna("Unknown", inplace=True)
```

## Remove Duplicates 

```{python}
data = data.drop_duplicates(subset=["TITLE", "COMPANY", "LOCATION", "POSTED"], keep="first")
```

# Exploratory Data Analysis 

## Job Postings by Industry

```{python}
import plotly.express as px
fig = px.bar(data["NAICS_2022_6_NAME"].value_counts(), title="Job Postings by Industry")
fig.show()
```

Job Posting Anaylsis 

## Salary Distribution by Industry

```{python}
fig = px.box(data, x="NAICS_2022_6_NAME", y="SALARY", title="Salary Distribution by Industry")
fig.show()
```

Job Posting Analysis

## Remote vs. On-Site Jobs

```{python}
fig = px.pie(data, names="REMOTE_TYPE_NAME", title="Remote vs. On-Site Jobs")
fig.show()
```

Remote vs. On-Site Jobs Analysis